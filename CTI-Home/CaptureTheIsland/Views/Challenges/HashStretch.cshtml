@{
    ViewData["Title"] = "Hash Stretch";
}

<h2 class="text-light">Hash Stretch</h2>

<p class="text-light">
    A suspicious MD5 hash was recovered from a compromised web server. Your task is to determine the
    plaintext password. This password is known to be <strong>weak</strong> and can be cracked using tools
    such as <strong>John the Ripper</strong>, <strong>Hashcat</strong>, or online lookup services.
</p>

<div class="card bg-secondary bg-opacity-25 border-light shadow-lg mb-4">
    <div class="card-body text-light">

        <h4 class="mb-3">🔐 The Hash</h4>
        <pre class="text-info">e10adc3949ba59abbe56e057f20f883e</pre>

        <h4 class="mt-4 mb-2">📘 How to Crack Using John the Ripper</h4>
        <p>Create a file named <code>hash.txt</code>:</p>
        <pre>echo "e10adc3949ba59abbe56e057f20f883e" > hash.txt</pre>

        <p>Run John:</p>
        <pre>john --format=raw-md5 hash.txt</pre>

        <p>Show results:</p>
        <pre>john --show hash.txt</pre>

        <h4 class="mt-4 mb-2">⚡ How to Crack Using Hashcat</h4>
        <p>Create a file named <code>hash.txt</code>:</p>
        <pre>echo "e10adc3949ba59abbe56e057f20f883e" > hash.txt</pre>

        <p>Run Hashcat using MD5 mode (0):</p>
        <pre>hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt</pre>

        <p>Show cracked results:</p>
        <pre>hashcat -m 0 --show hash.txt</pre>

        <h4 class="mt-4 mb-2">▶️ Tutorials</h4>
        <p>
            <a class="text-info" href="https://www.youtube.com/watch?v=nf9e9zZtz-E" target="_blank">
                🔗 Hashcat Tutorial for Beginners
            </a><br />
            <a class="text-info" href="https://www.youtube.com/watch?v=fVegA8QG1BE" target="_blank">
                🔗 John the Ripper Tutorial
            </a>
        </p>

        <h4 class="mt-4 mb-2">📚 Don’t Forget</h4>
        <p>
            Check the <strong>Resources Table</strong> on the Home Page for useful password lists,
            tools, and reference links.
        </p>
    </div>
</div>

<!-- Submission form -->
<form asp-action="SubmitHashStretch" method="post" class="mt-3">
    <input name="flag" class="form-control bg-dark text-light border-secondary"
           placeholder="Enter cracked password here" />

    <button type="submit" class="btn btn-primary mt-2">Submit Answer</button>
</form>

@if (TempData["Message"] != null)
{
    <div class="alert alert-success mt-3">@TempData["Message"]</div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger mt-3">@TempData["Error"]</div>
}

@if (TempData["Success"] != null)
{
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            markChallengeComplete("HashStretch");
        });
    </script>
}

<a href="/Challenges/Sample" class="btn btn-secondary mt-4">Back to Sample Challenges</a>

<a href="/Challenges/PNGOddities" class="btn btn-outline-info mt-4">
    Next Challenge → PNG Oddities
</a>
