@{
    ViewData["Title"] = "Medium Cryptography — Vigenère Cipher";
}

<div class="card bg-secondary bg-opacity-25 border-light shadow-lg p-4">
    <h2 class="text-center mb-4" style="color:white;">
        🟡 Medium — Vigenère Cipher
    </h2>

    <p class="text-light">
        Our analysts have obtained an encrypted message. We know it was encrypted using the
        <strong>Vigenère cipher</strong> with the key:
    </p>

    <p class="text-info fs-5"><strong>qizkwcgqbs</strong></p>

    <hr />

    <h4 class="text-light mt-4">🔐 Encrypted Message</h4>
    <p class="text-warning fs-5">
        <code>Y ln xkv lubj swlzqvkht, A vmzb pjk bbua we ddgs ILQ-GQYU-8026</code>
    </p>

    <p class="text-light">
        Decode the message using the Vigenère cipher and enter the plaintext below.
    </p>

    <form asp-action="SubmitCryptoMedium" method="post" class="mt-3">
        <input name="answer" class="form-control" placeholder="Enter decrypted message here" />

        <button type="submit" class="btn btn-primary mt-3">Submit Answer</button>
    </form>

    <!-- Results -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success mt-4">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-4">@TempData["Error"]</div>
    }

    <!-- Hints / Walkthrough Accordion -->
    <div class="accordion mt-4" id="vigAccordion">

        <!-- Hint -->
        <div class="accordion-item bg-dark text-light border-secondary">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#hint1">
                    Need a hint?
                </button>
            </h2>
            <div id="hint1" class="accordion-collapse collapse">
                <div class="accordion-body">
                    Try using an online Vigenère decoder such as
                    <a href="https://www.dcode.fr/vigenere-cipher" target="_blank">dCode</a> or CyberChef.
                </div>
            </div>
        </div>

        <!-- Full Walkthrough -->
        <div class="accordion-item bg-dark text-light border-secondary mt-3">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#walkthrough">
                    Full Walk-Through (Click to Expand)
                </button>
            </h2>

            <div id="walkthrough" class="accordion-collapse collapse">
                <div class="accordion-body">

                    <h4 class="text-info">Walk-Through</h4>

                    <p>This challenge will give you experience decoding <strong>polyalphabetic substitution ciphers</strong>. This message is encrypted using the Vigenère cipher.</p>

                    <p>
                        To start this challenge, take a look at the ciphertext. There is clear
                        formatting for something resembling the flag format, however, it does not
                        start with ‘SKY’. This is a clue that the encryption method does not move
                        the letters like the shift or transposition ciphers used in previous
                        challenges.
                    </p>

                    <p>
                        There is also a key: <strong>qizkwcgqbs</strong>.
                        A Vigenère cipher, named for cryptographer <em>Blaise de Vigenère</em>,
                        uses a key and encrypts letters in place as observed.
                    </p>

                    <p>A table, like the one from dcode.com below, is used to encrypt and decrypt the message in conjunction with the key.</p>

                    <img src="https://www.dcode.fr/tools/img/vigenere-square.png"
                         class="img-fluid border border-secondary mt-2 mb-3" />

                    <p>
                        To decrypt, find the row on the left side with the first letter of the key.
                        This challenge uses ‘Q’ as the first letter in the key. In row ‘Q’, scan
                        across the table until you find the first letter of the ciphertext ‘Y’.
                        Letter ‘Y’ is in the column of letter ‘I’, so the first letter of the
                        plaintext message starts with ‘I’.
                    </p>

                    <p>
                        The key has fewer letters than the message. Once all of the letters of the
                        key have been used, keep using the key over and over until all of the
                        ciphertext letters have been decrypted.
                    </p>

                    <p>
                        You can also use online tools to help you decode a Vigenère cipher.
                    </p>

                    <strong>Useful tools:</strong>
                    <ul>
                        <li><a href="https://www.dcode.fr/vigenere-cipher" target="_blank">dCode</a></li>
                        <li><a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a></li>
                    </ul>

                    <hr />

                    <h5 class="text-warning">Plaintext Solution (hidden until correct submission)</h5>
                    @if (TempData["ShowSolution"] != null)
                    {
                        <div class="alert alert-info mt-3">
                            <strong>Decrypted Message:</strong><br />
                            I am not your instructor, I will not give you SKY-HIGH-8026
                        </div>
                    }
                </div>
            </div>
        </div>

    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-between mt-4">
        <a href="/Challenges/Cryptography" class="btn btn-outline-light">← Back to Cryptography</a>

        <a href="/Challenges/CryptoHard" class="btn btn-outline-info">Next Challenge →</a>
    </div>
</div>

