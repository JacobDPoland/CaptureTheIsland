@{
    ViewData["Title"] = "Easy Forensics — Version Control";
}

<div class="card bg-secondary bg-opacity-25 border-light shadow-lg p-4">
    <h2 class="text-center mb-4" style="color:white;">
        🟩 Easy — Version Control
    </h2>

    <p class="text-light">
        One of our employee's computers was compromised. We intercepted a git backup leaving the network,
        but it only contains a simple <strong>README.md</strong>. Use git forensics to recover what was stolen.
    </p>

    <hr />

    <h4 class="text-light mt-4">📦 Challenge File</h4>
    <div class="row">
        <div class="col-md-8">
            <p class="text-info fs-6">
                <a href="~/files/CTI_git_challenge.zip" class="btn btn-outline-info" download>
                    ⬇ Download git_backup.zip
                </a>
            </p>
        </div>
        <div class="col-md-4">
            <p class="text-info fs-6"><strong>Extract → git log → find hidden commits</strong></p>
        </div>
    </div>

    <p class="text-light mt-3">
        Answer all 4 questions from the git repository history.
    </p>

    <form asp-action="SubmitForensicsEasy" method="post" class="mt-3">
        <label class="mt-3">
            <strong>1. Email address of compromised employee:</strong>
        </label>
        <input name="q1" class="form-control" placeholder="Example: user@example.com" />

        <label class="mt-3">
            <strong>2. Compromised flag from git history:</strong>
        </label>
        <input name="q2" class="form-control" placeholder="Example: CTI-XXXX-1234" />

        <label class="mt-3">
            <strong>3. Service provider with compromised credentials:</strong>
        </label>
        <input name="q3" class="form-control" placeholder="Example: gmail.com" />

        <label class="mt-3">
            <strong>4. Password for that compromised account:</strong>
        </label>
        <input name="q4" class="form-control" placeholder="Example: P@ssw0rd123" />

        <button type="submit" class="btn btn-primary mt-3">Submit Answers</button>
    </form>

    <!-- Results -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success mt-4">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-4">@TempData["Error"]</div>
    }

    @if (TempData["Success"] != null)
    {
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                markChallengeComplete("ForensicsEasy");
            });
        </script>
    }

    <!-- Hints / Walkthrough Accordion -->
    <div class="accordion mt-4" id="gitAccordion">

        <!-- Hint -->
        <div class="accordion-item bg-dark text-light border-secondary">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#hint1">
                    Need a hint?
                </button>
            </h2>
            <div id="hint1" class="accordion-collapse collapse">
                <div class="accordion-body">
                    • <code>unzip git_backup.zip</code><br>
                    • <code>ls -a</code> → see .git folder<br>
                    • <code>git log</code> → find deleted FLAG.txt commit<br>
                    • <code>git checkout next</code> → passwords.txt branch
                </div>
            </div>
        </div>

        <!-- Full Walkthrough -->
        <div class="accordion-item bg-dark text-light border-secondary mt-3">
            <h2 class="accordion-header">
                <button class="accordion-button bg-dark text-light collapsed"
                        type="button" data-bs-toggle="collapse" data-bs-target="#walkthrough">
                    Stuck? View Full Walk-Through
                </button>
            </h2>
            <div id="walkthrough" class="accordion-collapse collapse">
                <div class="accordion-body">
                    <h4 class="text-info">Git Forensics Walk-Through</h4>

                    <ol>
                        <li><strong>Unzip:</strong> <code>unzip git_backup.zip</code></li>
                        <li><strong>Hidden git:</strong> <code>ls -a</code> → .git folder exists</li>
                        <li><strong>Commit history:</strong> <code>git log</code> → Greg Peterson's commits + FLAG.txt deletion</li>
                        <li><strong>View commit:</strong> <code>git show [SHA]</code> → FLAG.txt contents</li>
                        <li><strong>Secret branch:</strong> <code>git branch</code> → "next" branch has passwords.txt</li>
                    </ol>

                    <p><strong>Tools:</strong> Any terminal with git</p>

                    <hr />
                    <h5 class="text-warning">Example format (not real answers):</h5>
                    <div class="alert alert-info mt-3">
                        • Q1 → employee@company.com<br>
                        • Q2 → CTI-FLAG-EXAMPLE-1234<br>
                        • Q3 → example.com<br>
                        • Q4 → P@ssw0rd123
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-between mt-4">
        <a href="/Challenges/Forensics" class="btn btn-outline-info">← Back to Forensics</a>
        <a href="/Challenges/ForensicsMedium" class="btn btn-outline-info">Next Challenge →</a>
    </div>


