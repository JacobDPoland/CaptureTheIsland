@{
    ViewData["Title"] = "OSINT Medium — Threat Intelligence";
}

<div class="card bg-secondary bg-opacity-25 border-light shadow-lg p-4">

    <h2 class="text-center mb-4" style="color:white;">🟡 Medium — Threat Intelligence</h2>

    <p class="text-light">
        This challenge gives you practice using <strong>open-source research</strong> to answer
        real-world vulnerability and cybersecurity history questions.
    </p>

    <p class="text-info">🔎 Tip: Wikipedia is a great starting point — but always confirm with multiple sources.</p>

    <hr class="border-secondary" />

    <h4 class="text-light">Questions</h4>

    <!-- ====================== -->
    <!--     SUBMISSION FORM    -->
    <!-- ====================== -->
    <form method="post" asp-action="SubmitOSINTMedium" class="text-light">

        <div class="mb-3">
            <label class="form-label">1. CVE of the original POODLE attack:</label>
            <input name="q1" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: CVE-2014-3566" />
        </div>

        <div class="mb-3">
            <label class="form-label">2. Version of VSFTPD with the backdoor:</label>
            <input name="q2" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: vsftpd 2.3.4" />
        </div>

        <div class="mb-3">
            <label class="form-label">3. First OpenSSL 1.0.1 version NOT vulnerable to Heartbleed:</label>
            <input name="q3" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: 1.0.1g" />
        </div>

        <div class="mb-3">
            <label class="form-label">4. RFC number describing Telnet:</label>
            <input name="q4" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: RFC 854 or 854" />
        </div>

        <div class="mb-3">
            <label class="form-label">5. SQL Slammer worm size (bytes):</label>
            <input name="q5" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: 376 or 376 bytes" />
        </div>

        <div class="mb-3">
            <label class="form-label">6. Complete the sentence: “Samy is my…”</label>
            <input name="q6" class="form-control bg-dark text-light border-secondary"
                   placeholder="ex: hero" />
        </div>

        <button type="submit" class="btn btn-primary mt-2">Submit Answers</button>
    </form>

    <!-- ====================== -->
    <!--  SUCCESS & ERROR BOXES -->
    <!-- ====================== -->
    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success mt-3">
            ✅ @TempData["Success"]
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                markChallengeComplete("OSINT_Medium");
            });
        </script>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger mt-3">
            ❌ @TempData["Error"]
        </div>
    }

    @if (TempData["Success"] != null)
    {
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                markChallengeComplete("OSINT_Medium");
            });
        </script>
    }

    <hr class="border-secondary" />

    <!-- Walkthrough -->
    <details class="mt-3">
        <summary class="text-info">📘 Walkthrough (Click to expand)</summary>
        <div class="text-light mt-2">

            <p>The answers can be found by searching Wikipedia for:</p>

            <ul>
                <li>POODLE Attack</li>
                <li>VSFTPD Backdoor</li>
                <li>Heartbleed</li>
                <li>Telnet</li>
                <li>SQL Slammer</li>
                <li>Samy Worm</li>
            </ul>

            <p class="mt-3">Correct Answers:</p>

            <ul>
                <li><strong>CVE:</strong> CVE-2014-3566</li>
                <li><strong>VSFTPD Version:</strong> 2.3.4</li>
                <li><strong>Fixed OpenSSL Version:</strong> 1.0.1g</li>
                <li><strong>RFC:</strong> RFC 854</li>
                <li><strong>SQL Slammer Size:</strong> 376 bytes</li>
                <li><strong>Samy is my:</strong> hero</li>
            </ul>

        </div>
    </details>

    <div class="d-flex justify-content-between mt-4">
        <a href="/Challenges/OSINT_Easy" class="btn btn-outline-light">← Back</a>
        <a href="/Challenges/OSINT_Hard" class="btn btn-primary">Next Challenge →</a>
    </div>

</div>
